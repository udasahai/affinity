{"filter":false,"title":"App.js","tooltip":"/client/src/Components/App.js","undoManager":{"mark":1,"position":1,"stack":[[{"start":{"row":0,"column":0},"end":{"row":241,"column":18},"action":"insert","lines":["","import React from \"react\"","import {CardColumns,Form, Dropdown, ModalTitle} from 'react-bootstrap'","import Tile from \"./Tile\"","import {tileData} from \"../data\"","import \"./App.css\"","","","class App extends React.Component {","","  constructor(props) {","    super(props);","    this.state = {","    \tvalue: '',","    \tselections_department: 0,","    \tselections_research: \"\",","    \tresearch_interest : null, ","    \tdepartment: null, ","    \tresponse: null,","    \tisLoaded: false","};","","    this.handleChange = this.handleChange.bind(this);","    this.callApi = this.callApi.bind(this);","    this.department_selection = this.department_selection.bind(this);","    this.change_research = this.change_research.bind(this)","  }","","","","  handleChange(event) {","    this.setState({value: event.target.value});","  }","","  department_selection(event){","  \tthis.setState({","  \t\tselections_department: event.target.value","  \t})","  }","","change_research(event){","    if (event.which == 13 || event.keyCode == 13) {","\t    this.setState({","\t  \t\tselections_research: event.target.value","\t  \t})","    }","}","","getTargetId(id){","\tvar str = `/users/targetid?targetid=${id}`;","\t","\treturn fetch(str).then(","\t\tfunction(data){","\t\t\treturn data.json()","\t\t}","\t)","}","","getInfo(){","\tvar str = \"/login\"","\t","\treturn fetch(str).then(","\t\tfunction(data){","\t\t\treturn data.json()","\t\t}","\t)","}","",""," componentDidMount() {","","","\t\tvar that = this; ","","\t\tthis.getInfo().then(function (data) {","\t\t\t// data[\"SHIBEDUPERSONTARGETEDID\"] = \"wilcox\"","\t\t\tlocalStorage.setItem(\"SHIBEDUPERSONAFFILIATION\", data[\"SHIBEDUPERSONAFFILIATION\"])","\t\t\tlocalStorage.setItem(\"SHIBEDUPERSONPRINCIPALNAME\", data[\"SHIBEDUPERSONPRINCIPALNAME\"])","\t\t\tlocalStorage.setItem(\"SHIBEDUPERSONTARGETEDID\", data[\"SHIBEDUPERSONTARGETEDID\"])","\t\t\tlocalStorage.setItem(\"SHIBMAIL\", data[\"SHIBMAIL\"])","\t\t\tlocalStorage.setItem(\"SHIBGIVENNAME\", data[\"SHIBGIVENNAME\"])","\t\t\treturn that.getTargetId(data[\"SHIBEDUPERSONTARGETEDID\"])","\t\t}).then(function (data){","\t\t\t// localStorage.setItem","\t\t\tdata.body.length > 0 ? localStorage.setItem(\"ISCLAIMED\", \"true\") : localStorage.setItem(\"ISCLAIMED\", \"false\")","\t\t\t// return that.callApi()","\t\t\t// localStorage.setItem(\"ISCLAIMED\", \"false\")","\t\t\treturn that.callApi()","\t\t})","      .then(res => this.setState({isLoaded: true}))","      .catch(err => console.log(err));","  }","","","callApi(){","","\tvar self = this; ","\tvar str = \"\" ;","\t// var str = 'https://ushare.idre.ucla.edu/ushare/api'; ","","","\treturn fetch(str + '/users')","\t  .then(function(response) {","\t    return response.json();","\t  })","\t  .then(function(data) {","\t  \tif (data.status !== 200) throw Error();","\t\tself.setState({response: (data.body) })","\t\treturn fetch(str +'/department')","\t  })","\t  .then(function(response){","\t  \treturn response.json();","\t  })","\t  .then(function(data){","\t  \tif (data.status !== 200) throw Error();","\t  \tself.setState({department: data.body})","\t  \treturn fetch(str +'/research_interest')","\t  }).then(function(response){","\t  \treturn response.json()","\t  }).then(function(data){","\t  \tif (data.status !== 200) throw Error();","\t  \tself.setState({research_interest: data.body})","\t  \treturn true; ","\t  })","","}","","","// callApi(){","","// \treturn fetch('/users').then(function(response){","// \t\tlet res = response.clone().json()","// \t\tconsole.log(res);","// \t\treturn res;","// \t})","// };",""," // callApi = async () => {"," //    const response = await fetch('/users');"," //    const body = await response.json();"," //    if (response.status !== 200) throw Error(body.message);"," //    return body;"," //  };","",""," tileComponents(){",""," \t\t\tvar value = this.state.value; "," \t\t\tvar selection = this.state.selections_department;"," \t\t\tvar selections_research = this.state.selections_research;",""," \t\t\tvar data = this.state.response;",""," \t\t\tif(selections_research.length > 0){"," \t\t\t\tvalue = value.toLowerCase();","\t \t\t\tdata = data.filter(function(tile){","\t \t\t\t\treturn tile.researchInterests.toLowerCase().includes(selections_research.toLowerCase())","\t \t\t\t})"," \t\t\t}",""," \t\t\tif(value.length >= 3){"," \t\t\t\tdata = data.filter(function(tile){","\t \t\t\t\treturn (tile.firstName.toLowerCase().includes(value) || tile.lastName.toLowerCase().includes(value))","\t \t\t\t})"," \t\t\t}","",""," \t\t\tif(selection > 0){"," \t\t\t\tdata = data.filter(function(tile){"," \t\t\t\t\treturn tile.departmentID == selection"," \t\t\t\t})"," \t\t\t}","","\t\t\t//  console.log(data[0])","","\t\t\t// data = data.map(tile => {","\t\t\t\t","\t\t\t// \ttile[\"fullname\"] = tile.firstName + \" \" + tile.lastName","\t\t\t// \t// tilel[\"\"]","\t\t\t// \ttile[\"interests\"] = tile.researchInterests.split(\",\")","\t\t\t// })","","\t\t\tfor (var i=0; i<data.length; i++){","\t\t\t\tdata[i][\"fullname\"] = data[i].firstName + \" \" + data[i].lastName","\t\t\t\tdata[i][\"interests\"] = data[i].researchInterests.split(\",\")","\t\t\t}","","\t\t\t// console.log(data)",""," \t\t\treturn data.map(tile => (","\t\t\t<Tile key={tile.userID}","\t\t\t// contact={{name: tile.firstName + \" \" + tile.lastName , imgUrl: tile.profilePicture, ","\t\t\t// email: tile.email, interests: tile.researchInterests, userID: tile.userID, claimed: tile.claimed, data: tile}}","\t\t\tcontact={tile}","\t\t\t/>","    ))}","","\trender(){","","\t\treturn(","\t\t<div>","\t\t<div id=\"search\"> ","\t\t<Form id = \"form\">","\t\t  <Form.Group controlId=\"formBasicEmail\">","\t\t    <Form.Control type=\"text\" onKeyUp={this.handleChange} placeholder=\"Enter Name\" />","\t\t  </Form.Group>","\t\t</Form>","\t\t<div id=\"drop\"> ","\t\t\t<select value={this.state.selections_department} onChange={this.department_selection}> ","\t\t\t\t<option value={0}> All </option>","\t\t\t  {","\t\t\t  !this.state.isLoaded ? <option value={0}>Loading</option> :","\t\t\t  this.state.department.map(dep => <option key={dep.name} value={dep.DepartmentID}>{dep.name}</option>)","\t\t\t  }","\t\t\t</select> ","","\t\t\t<input list=\"interests\" onKeyPress={this.change_research}/>","\t\t\t<datalist id=\"interests\"> ","","\t\t\t    {","\t\t\t    \t!this.state.isLoaded ? <option value={0}/> :","\t\t\t    \tthis.state.research_interest.map((item) =>","\t\t\t      <option key={item.research_interestID} value={item.keyword} />","\t\t\t    )","","\t\t\t    }","\t\t\t</datalist>","","\t\t</div> ","\t\t</div> ","\t\t<div id=\"deck\">","\t\t\t<CardColumns>","\t\t\t\t{!this.state.isLoaded ? \"...Loading\" : this.tileComponents()}","\t\t\t</CardColumns>","\t\t</div> ","\t\t</div>","\t\t\t)","","\t}","}","","export default App"],"id":1}],[{"start":{"row":0,"column":0},"end":{"row":1,"column":0},"action":"remove","lines":["",""],"id":2},{"start":{"row":1,"column":8},"end":{"row":105,"column":1},"action":"remove","lines":["CardColumns,Form, Dropdown, ModalTitle} from 'react-bootstrap'","import Tile from \"./Tile\"","import {tileData} from \"../data\"","import \"./App.css\"","","","class App extends React.Component {","","  constructor(props) {","    super(props);","    this.state = {","    \tvalue: '',","    \tselections_department: 0,","    \tselections_research: \"\",","    \tresearch_interest : null, ","    \tdepartment: null, ","    \tresponse: null,","    \tisLoaded: false","};","","    this.handleChange = this.handleChange.bind(this);","    this.callApi = this.callApi.bind(this);","    this.department_selection = this.department_selection.bind(this);","    this.change_research = this.change_research.bind(this)","  }","","","","  handleChange(event) {","    this.setState({value: event.target.value});","  }","","  department_selection(event){","  \tthis.setState({","  \t\tselections_department: event.target.value","  \t})","  }","","change_research(event){","    if (event.which == 13 || event.keyCode == 13) {","\t    this.setState({","\t  \t\tselections_research: event.target.value","\t  \t})","    }","}","","getTargetId(id){","\tvar str = `/users/targetid?targetid=${id}`;","\t","\treturn fetch(str).then(","\t\tfunction(data){","\t\t\treturn data.json()","\t\t}","\t)","}","","getInfo(){","\tvar str = \"/login\"","\t","\treturn fetch(str).then(","\t\tfunction(data){","\t\t\treturn data.json()","\t\t}","\t)","}","",""," componentDidMount() {","","","\t\tvar that = this; ","","\t\tthis.getInfo().then(function (data) {","\t\t\t// data[\"SHIBEDUPERSONTARGETEDID\"] = \"wilcox\"","\t\t\tlocalStorage.setItem(\"SHIBEDUPERSONAFFILIATION\", data[\"SHIBEDUPERSONAFFILIATION\"])","\t\t\tlocalStorage.setItem(\"SHIBEDUPERSONPRINCIPALNAME\", data[\"SHIBEDUPERSONPRINCIPALNAME\"])","\t\t\tlocalStorage.setItem(\"SHIBEDUPERSONTARGETEDID\", data[\"SHIBEDUPERSONTARGETEDID\"])","\t\t\tlocalStorage.setItem(\"SHIBMAIL\", data[\"SHIBMAIL\"])","\t\t\tlocalStorage.setItem(\"SHIBGIVENNAME\", data[\"SHIBGIVENNAME\"])","\t\t\treturn that.getTargetId(data[\"SHIBEDUPERSONTARGETEDID\"])","\t\t}).then(function (data){","\t\t\t// localStorage.setItem","\t\t\tdata.body.length > 0 ? localStorage.setItem(\"ISCLAIMED\", \"true\") : localStorage.setItem(\"ISCLAIMED\", \"false\")","\t\t\t// return that.callApi()","\t\t\t// localStorage.setItem(\"ISCLAIMED\", \"false\")","\t\t\treturn that.callApi()","\t\t})","      .then(res => this.setState({isLoaded: true}))","      .catch(err => console.log(err));","  }","","","callApi(){","","\tvar self = this; ","\tvar str = \"\" ;","\t// var str = 'https://ushare.idre.ucla.edu/ushare/api'; ","","","\treturn fetch(str + '/users')","\t  .then(function(response) {","\t    return response.json();","\t  })","\t  .then(function(data) {","\t"]},{"start":{"row":1,"column":8},"end":{"row":105,"column":0},"action":"insert","lines":[" CardColumns, Form, Dropdown, ModalTitle } from 'react-bootstrap'","import Tile from \"./Tile\"","import { tileData } from \"../data\"","import \"./App.css\"","","","class App extends React.Component {","","    constructor(props) {","        super(props);","        this.state = {","            value: '',","            selections_department: 0,","            selections_research: \"\",","            research_interest: null,","            department: null,","            response: null,","            isLoaded: false","        };","","        this.handleChange = this.handleChange.bind(this);","        this.callApi = this.callApi.bind(this);","        this.department_selection = this.department_selection.bind(this);","        this.change_research = this.change_research.bind(this)","    }","","","","    handleChange(event) {","        this.setState({ value: event.target.value });","    }","","    department_selection(event) {","        this.setState({","            selections_department: event.target.value","        })","    }","","    change_research(event) {","        if (event.which == 13 || event.keyCode == 13) {","            this.setState({","                selections_research: event.target.value","            })","        }","    }","","    getTargetId(id) {","        var str = `/users/targetid?targetid=${id}`;","","        return fetch(str).then(","            function(data) {","                return data.json()","            }","        )","    }","","    getInfo() {","        var str = \"/login\"","","        return fetch(str).then(","            function(data) {","                return data.json()","            }","        )","    }","","","    componentDidMount() {","","","        var that = this;","","        this.getInfo().then(function(data) {","                // data[\"SHIBEDUPERSONTARGETEDID\"] = \"wilcox\"","                localStorage.setItem(\"SHIBEDUPERSONAFFILIATION\", data[\"SHIBEDUPERSONAFFILIATION\"])","                localStorage.setItem(\"SHIBEDUPERSONPRINCIPALNAME\", data[\"SHIBEDUPERSONPRINCIPALNAME\"])","                localStorage.setItem(\"SHIBEDUPERSONTARGETEDID\", data[\"SHIBEDUPERSONTARGETEDID\"])","                localStorage.setItem(\"SHIBMAIL\", data[\"SHIBMAIL\"])","                localStorage.setItem(\"SHIBGIVENNAME\", data[\"SHIBGIVENNAME\"])","                return that.getTargetId(data[\"SHIBEDUPERSONTARGETEDID\"])","            }).then(function(data) {","                // localStorage.setItem","                data.body.length > 0 ? localStorage.setItem(\"ISCLAIMED\", \"true\") : localStorage.setItem(\"ISCLAIMED\", \"false\")","                // return that.callApi()","                // localStorage.setItem(\"ISCLAIMED\", \"false\")","                return that.callApi()","            })","            .then(res => this.setState({ isLoaded: true }))","            .catch(err => console.log(err));","    }","","","    callApi() {","","        var self = this;","        var str = \"\";","        // var str = 'https://ushare.idre.ucla.edu/ushare/api'; ","","","        return fetch(str + '/users')","            .then(function(response) {","                return response.json();","            })","            .then(function(data) {",""]},{"start":{"row":105,"column":2},"end":{"row":189,"column":3},"action":"remove","lines":["\tif (data.status !== 200) throw Error();","\t\tself.setState({response: (data.body) })","\t\treturn fetch(str +'/department')","\t  })","\t  .then(function(response){","\t  \treturn response.json();","\t  })","\t  .then(function(data){","\t  \tif (data.status !== 200) throw Error();","\t  \tself.setState({department: data.body})","\t  \treturn fetch(str +'/research_interest')","\t  }).then(function(response){","\t  \treturn response.json()","\t  }).then(function(data){","\t  \tif (data.status !== 200) throw Error();","\t  \tself.setState({research_interest: data.body})","\t  \treturn true; ","\t  })","","}","","","// callApi(){","","// \treturn fetch('/users').then(function(response){","// \t\tlet res = response.clone().json()","// \t\tconsole.log(res);","// \t\treturn res;","// \t})","// };",""," // callApi = async () => {"," //    const response = await fetch('/users');"," //    const body = await response.json();"," //    if (response.status !== 200) throw Error(body.message);"," //    return body;"," //  };","",""," tileComponents(){",""," \t\t\tvar value = this.state.value; "," \t\t\tvar selection = this.state.selections_department;"," \t\t\tvar selections_research = this.state.selections_research;",""," \t\t\tvar data = this.state.response;",""," \t\t\tif(selections_research.length > 0){"," \t\t\t\tvalue = value.toLowerCase();","\t \t\t\tdata = data.filter(function(tile){","\t \t\t\t\treturn tile.researchInterests.toLowerCase().includes(selections_research.toLowerCase())","\t \t\t\t})"," \t\t\t}",""," \t\t\tif(value.length >= 3){"," \t\t\t\tdata = data.filter(function(tile){","\t \t\t\t\treturn (tile.firstName.toLowerCase().includes(value) || tile.lastName.toLowerCase().includes(value))","\t \t\t\t})"," \t\t\t}","",""," \t\t\tif(selection > 0){"," \t\t\t\tdata = data.filter(function(tile){"," \t\t\t\t\treturn tile.departmentID == selection"," \t\t\t\t})"," \t\t\t}","","\t\t\t//  console.log(data[0])","","\t\t\t// data = data.map(tile => {","\t\t\t\t","\t\t\t// \ttile[\"fullname\"] = tile.firstName + \" \" + tile.lastName","\t\t\t// \t// tilel[\"\"]","\t\t\t// \ttile[\"interests\"] = tile.researchInterests.split(\",\")","\t\t\t// })","","\t\t\tfor (var i=0; i<data.length; i++){","\t\t\t\tdata[i][\"fullname\"] = data[i].firstName + \" \" + data[i].lastName","\t\t\t\tdata[i][\"interests\"] = data[i].researchInterests.split(\",\")","\t\t\t}","","\t\t\t// console.log(data)",""," \t\t\treturn data.map(tile => (","\t\t\t"]},{"start":{"row":105,"column":2},"end":{"row":189,"column":12},"action":"insert","lines":["              if (data.status !== 200) throw Error();","                self.setState({ response: (data.body) })","                return fetch(str + '/department')","            })","            .then(function(response) {","                return response.json();","            })","            .then(function(data) {","                if (data.status !== 200) throw Error();","                self.setState({ department: data.body })","                return fetch(str + '/research_interest')","            }).then(function(response) {","                return response.json()","            }).then(function(data) {","                if (data.status !== 200) throw Error();","                self.setState({ research_interest: data.body })","                return true;","            })","","    }","","","    // callApi(){","","    // \treturn fetch('/users').then(function(response){","    // \t\tlet res = response.clone().json()","    // \t\tconsole.log(res);","    // \t\treturn res;","    // \t})","    // };","","    // callApi = async () => {","    //    const response = await fetch('/users');","    //    const body = await response.json();","    //    if (response.status !== 200) throw Error(body.message);","    //    return body;","    //  };","","","    tileComponents() {","","        var value = this.state.value;","        var selection = this.state.selections_department;","        var selections_research = this.state.selections_research;","","        var data = this.state.response;","","        if (selections_research.length > 0) {","            value = value.toLowerCase();","            data = data.filter(function(tile) {","                return tile.researchInterests.toLowerCase().includes(selections_research.toLowerCase())","            })","        }","","        if (value.length >= 3) {","            data = data.filter(function(tile) {","                return (tile.firstName.toLowerCase().includes(value) || tile.lastName.toLowerCase().includes(value))","            })","        }","","","        if (selection > 0) {","            data = data.filter(function(tile) {","                return tile.departmentID == selection","            })","        }","","        //  console.log(data[0])","","        // data = data.map(tile => {","","        // \ttile[\"fullname\"] = tile.firstName + \" \" + tile.lastName","        // \t// tilel[\"\"]","        // \ttile[\"interests\"] = tile.researchInterests.split(\",\")","        // })","","        for (var i = 0; i < data.length; i++) {","            data[i][\"fullname\"] = data[i].firstName + \" \" + data[i].lastName","            data[i][\"interests\"] = data[i].researchInterests.split(\",\")","        }","","        // console.log(data)","","        return data.map(tile => (","            "]},{"start":{"row":194,"column":4},"end":{"row":199,"column":2},"action":"remove","lines":["))}","","\trender(){","","\t\treturn(","\t\t"]},{"start":{"row":194,"column":4},"end":{"row":200,"column":12},"action":"insert","lines":["    ))","    }","","    render() {","","        return (","            "]},{"start":{"row":236,"column":0},"end":{"row":238,"column":1},"action":"remove","lines":["\t\t\t)","","\t"]},{"start":{"row":236,"column":0},"end":{"row":238,"column":4},"action":"insert","lines":["        )","","    "]},{"start":{"row":241,"column":18},"end":{"row":242,"column":0},"action":"insert","lines":["",""]}]]},"ace":{"folds":[],"scrolltop":74,"scrollleft":0,"selection":{"start":{"row":105,"column":0},"end":{"row":105,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1584861307373,"hash":"86fc4c015e4e26f7528383e1de0d045bdaa06d36"}